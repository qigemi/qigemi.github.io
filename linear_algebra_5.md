---
layout: post
---

哦，进行到特征值了，这部分内容可能比较多。

#14.特征值和特征向量
恭喜，我们似乎终于进入了更核心的部分，在四个基本子空间之后。特征向量我们都比较了解了，就是经过线性变换后方向不变的那些向量。

$$Ax=\lambda x$$

如何求解特征值和特征向量，根据上式先求特征值：

$$\begin{align} & Ax-\lambda x&=0 \\ \Rightarrow \  & (A-\lambda I)x&=0 \\ \Rightarrow \  & det\ (A-\lambda I)&=0\end{align}$$

因为零向量变换后还是零向量，所以我们考虑 $x\neq 0$ 的情况。一个矩阵将非零向量变换为零向量，则该矩阵为奇异矩阵，行列式为零。解方程可以得到n个特征值（不一定是互异的）。然后分别求每个特征值对应的 $A-\lambda I$ 的零空间，零空间的基向量就是这个特征值对应的特征向量，零空间如果是高维的（特征值为重根），则一个特征值可能对应多个特征向量。**n维矩阵一定有n个特征值，但不一定有n个线性无关的特征向量**。

这些大家应该都比较了解了，这里说点有意思的。

用二维矩阵举个例子，

$$A=\left[\begin{matrix}a & b \\ c & d \end{matrix}\right] \\
det\ (A-\lambda I) = (a-\lambda)(d-\lambda)-bc=0 \\
\Rightarrow \lambda ^2-(a+d)\lambda+(ad-bc) \\
\Rightarrow \left\{\begin{matrix}\lambda_1\lambda_2=ad-bc=det\ A \\ \lambda_1+\lambda_2=a+d=tr(A) \end{matrix}\right.$$

这一规律可以推广到高维矩阵情况，**特征值的和等于矩阵的迹，相乘等于矩阵的行列式**。所以奇异矩阵一定有一个特征值0。

还有一条，**对称矩阵只有实特征值，且特征向量互相垂直；反对称矩阵只有复特征值**。这就很有意思了，后面可能会写一下证明。

#15.对角化
假设A有n个线性无关的特征向量，将它们作为列组成矩阵S，则有

$$A\left[x_1\ x_2...x_n\right]=\left[x_1\ x_2...x_n\right]\left[\begin{matrix}\lambda_1 & & \\ &\ddots&\\&&\lambda_n\end{matrix}\right] \\
\Rightarrow A=S\Lambda S^{-1} , S^{-1}AS=\Lambda$$

因为特征向量是线性无关的，所以S可逆。有些矩阵是没有n个线性无关的特征向量的，但大部分矩阵有。上式就是矩阵对角化过程和矩阵分解过程，它们是等价的。由此我们能发现矩阵n次幂的特点。

$$A^n=S\Lambda^n S^{-1}$$

中间的很多S和S的逆消掉了，结果就是A的n次方和A有相同的特征向量，而其特征值是A的n次幂。特征值和特征向量让我们更方便的了解矩阵幂的一些特性，这是之前的LU分解QR分解等不能提供的。**比如 $\lim_{n\rightarrow \infty}A^n=0$ 当且仅当 $|\lambda_i|<1,i=1,2,...,n$，注意特征值可能是复数**。

上述推论都是在A有n个线性无关的特征向量的前提下得出的。**当A有n个互异的特征值时，A有n个线性无关的特征向量，即A可以对角化**。注意如果有重复的特征值，则矩阵可能可以对角化也可能不能，比如单位阵就有n个线性无关的特征向量。好在大部分矩阵都是可以对角化的，用对角化的分解可以做下面几个事。

##差分方程
讲道理我也不知道这是什么，它大概就是这么个形式，有一个初始向量 $u_0$，然后有一个递推公式 $u_{k+1}=Au_k$，则 $u_k=A^ku_0$。我们可以用矩阵对角化分解快速计算 $u_k$。这里有一个trick，将 $u_0$ 表示成A的特征向量的线性组合：

$$u_0=c_1x_1+c_2x_2+...+c_nx_n\tag1$$

那么最后的结果可以写成：

$$u_k=c_1\lambda_1^kx_1+...+c_n\lambda_n^kx_n$$

一个例子是计算斐波那契数列。斐波那契数列后一项是前两项的和：0，1，1，2，3，5，8，13，21，……。这个递推公式怎么写呢，可以把两项写成一个向量：

$$u_0=\left[\begin{matrix}0 \\ 1\end{matrix}\right],A=\left[\begin{matrix}1 &1 \\ 1&0\end{matrix}\right]$$

好了，现在求A的特征值和特征向量。就直接写了：

$$\lambda_1 = \frac{1+\sqrt{5}}{2}\approx 1.618 \\
\lambda_2 = \frac{1-\sqrt{5}}{2}\approx -0.618 \\
x_1=\left[\begin{matrix} \lambda_1 \\ 1\end{matrix}\right],x_2=\left[\begin{matrix}\lambda_2 \\ 1\end{matrix}\right]$$

然后求出 $c_1,c_2$ 就可以带入公式计算了。这里可以看出为什么斐波那契数列后一项比前一项的极限是1.618，因为k趋于无穷大时，第二个特征值贡献为零，只剩下第一项，约等于每次乘以 $\lambda_1$。类似的差分方程都可以用这种方法求解。

##微分方程
微分方程我也不太熟悉，以前求定积分比较多。这里应该求解的是一阶齐次线性微分方程：

$$\frac{du}{dt}=Au$$

例子，求解：

$$\left\{\begin{matrix}
\frac{du_1}{dt}=-u_1+2u_2 \\ \frac{du_2}{dt}=u_1-2u_2
\end{matrix}\right.
\quad given\ u(0)=\left[\begin{matrix}1\\0\end{matrix}\right]$$

给一个初值，给出每部分随时间的变化，然后求t时刻时u的状态。先写出矩阵A 并求解特征值

$$A=\left[\begin{matrix}-1&2\\1&-1\end{matrix}\right] \\
\lambda_1=0,\lambda_2=-3 \\
x_1=\left[\begin{matrix}2\\1\end{matrix}\right],x_2=\left[\begin{matrix}1\\-1\end{matrix}\right]$$

因为我不会求这个东西，然后就猜了一下（视频里是这样猜的…），解大概是这两项的和，

$$u(t)=c_1e^{\lambda_1 t}x_1+c_2e^{\lambda_2 t}x_2\tag2$$

这两项其实是两个特解，然后线性组合组成通解。下面只要根据 u(0) 确定系数就行了。注意这个解的形式和差分方程解的形式(1)的相似性。由该公式可以看出u随t的变化情况：如果特征值（考虑它是复数）的实部小于0，则该项指数会随着时间趋于0；如果特征值实部等于0，则最后该项等于常数；如果特征值实部大于0，则最后结果会发散。

不管是差分方程还是微分方程，一开始向量中的各元素都是耦合在一起的，它们之间的线性关系用矩阵A表示。对角化的过程就是解耦的过程，最后的结果都可以用每个分量相加的形式表示。**这是因为我们选择了不同的基**，我们选择平凡的基时这些分量是耦合在一起的，其线性变换的结果要依赖于其他分量，而选择线性无关的特征向量作为基时，每个分量就解耦了，在线性变换的作用下，它们自己变自己的（因为它们是特征向量，只会变化scale）。所以线性变换还是那个线性变换，只是基选择的不一样，表达形式就不一样，这也是矩阵相似的意义。A和 $\Lambda$ 是相似的，因为本质上它们表示相同的线性变换。

好了，我们更进一步看看为什么特解是这样的。把 u 写成以特征向量为基的形式：

$$u=Sv \\ \Rightarrow S\frac{dv}{dt}=ASv \\
\Rightarrow \frac{dv}{dt}=S^{-1}ASv=\Lambda v \\

\Rightarrow \left\{\begin{matrix}
\frac{dv_1}{dt}=\lambda_1v_1 \\ \vdots \\ \frac{dv_n}{dt}=\lambda_nv_n
\end{matrix}\right. \\

\Rightarrow \left\{\begin{matrix}
v_1=c_1e^{\lambda_1 t} \\ \vdots \\ v_n=c_ne^{\lambda_n t}
\end{matrix}\right.$$

我已经尽量写清楚了，不知道大家能不能看懂。这样我们就得到了上面猜的特解形式。另外我们还得到了e的矩阵次幂的形式（从微分方程把矩阵看作一个数，直接求解）

$$u(t)=e^{At}u(0)$$

那么e的矩阵次幂是什么东西呢。 同样用泰勒展开定义：

$$e^A=I+A+\frac{A^2}{2!}+\frac{A^3}{3!}+\cdots$$

这样就可以用矩阵的幂表示了。如果A可以对角化，那么还可以进一步写成：

$$e^A=Se^\Lambda S^{-1}=S\left[\begin{matrix}e^{\lambda_1} & & \\ &\ddots&\\&&e^{\lambda_n}\end{matrix}\right]S^{-1}$$

这就和(2)的形式对上了，累死我了……

最后，如果是二阶微分方程怎么办，参考斐波那契数列。

这节课内容有点多，首先是对角化，然后应用对角化简化矩阵幂级数的形式，求解差分方程。最后推广了e的矩阵指数形式，并求解微分方程。

#16. 傅里叶变换
当我们选择一组单位正交基 $\{q_i\}$ 表示一个向量时：

$$v=x_1q_1+x_2q_2+\cdots + x_nq_n$$

如何求其系数。由于单位正交性求系数的过程很简单：

$$q_1^Tv=x_1\cdot I+0+\cdots +0 \\ \Rightarrow x_1=q_1^Tv$$

我们也可以把向量扩展为函数（函数也可以看成无穷维向量），即一个函数可以表示成一系列函数线性组合的形式，我们可以选择无穷个函数作为基，它们也可以是正交关系。函数的正交怎么定义，可以参考向量内积：

$$<f,g>=\int f(x)g(x)dx$$

如果函数内积等于0，则两函数正交。所以我们可以选择如下正交函数作为基：

$$1,\cos x,\sin x,\cos 2x,\sin 2x,\cdots \\
f(x)=a_0+a_1\cos x+b_1\sin x+a_2\cos 2x+b_2\sin 2x+\cdots$$

这就是傅里叶变换。所以怎么求这些系数呢，和向量差不多，但是注意这些函数和自身的内积不是1，它们只是正交的，不是“单位”的。上式左右两边乘以cos x求积分得：

$$\int_{0}^{2\pi} f(x)\cos xdx=a_1\int_{0}^{2\pi}\cos ^2xdx \\
\Rightarrow a_1=\frac{1}{\pi}\int_{0}^{2\pi} f(x)\cos xdx$$
