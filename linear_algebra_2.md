---
layout: post
---

这部分开始主要介绍向量空间，矩阵的四个向量空间及其维度关系等。

# 4.向量空间（vector space）
向量空间首先是一个线性空间，需要满足对线性组合封闭，即空间中的向量经过线性组合还在这个空间中。常见的空间比如 $\mathbb R^n$，但是还有一些小一点的空间，不需要包含 $\mathbb R^n$ 中的所有向量，但是也组成一个向量空间，这种空间叫子空间（subspace）。比如二维空间中过原点的一条直线，三维空间中过原点的直线和平面都是子空间，只有原点的集合也是一个子空间。注意**子空间必须包含原点**，因为向量空间必须满足线性封闭，任意向量乘以0都等于零向量，所以原点必须包含在向量空间中，这也是判断一个集合是不是向量空间的比较简便的方法。  

子空间的并集不一定是向量空间，交集一定是向量空间。

# 5.列空间和零空间
下面就要和矩阵扯上关系了，一个矩阵可以定义四个子空间。首先从列空间开始。

## 列空间
由矩阵的所有列的线性组合组成的集合（子空间）叫做矩阵 $A$ 的列空间（colum space），记作 $C(A)$。对于一个 $m\times n$ 的矩阵，列空间是m维空间中的子空间，即 $C(A_{m\times n})\in \mathbb R^m$。（这里请思考一下为什么列空间是一个向量空间。）举个例子：

$$A=\left[\begin{matrix} 1 & 1 & 2 \\ 3 & 1 & 4 \\ 5 & 1 & 6 \\ 4 & 1 & 5  \end{matrix}\right]\tag 1$$

该矩阵的列空间是四维空间中的子空间，这个矩阵虽然有三列，但是它们不是线性无关的（第三列等于前两列之和），所以他们的所有线性组合组成的集合是四维空间中的二维平面。可以只用其中的两列作为主列生成列空间。上述矩阵的列空间可以表示为：

$$C(A)=a\left[\begin{matrix} 1 \\ 3 \\ 5 \\ 4 \end{matrix}\right]+b\left[\begin{matrix} 1 \\ 1 \\ 1 \\ 1 \end{matrix}\right],\ a,b\in \mathbb R$$

有了列空间，我们进一步讨论它和方程 $Ax=b$ 的解的关系。因为Ax得到的所有向量都在A的列空间中，即 $\forall x\in \mathbb R^n, Ax\in C(A)$。所以**方程组Ax=b有解，当且仅当b在A的列空间中**。

## 零空间
零空间（null space）$N(A)=\{x|Ax=0\}$，即所有使Ax=0的x集合，也可以说A的零空间是方程组Ax=0的解空间。对于一个 $m\times n$ 的矩阵，零空间是n维空间中的子空间，即 $N(A_{m\times n})\in \mathbb R^n$。（请思考为什么零空间是向量空间。）对于上述例子，其零空间是三维空间中的一条直线，可表示为：

$$N(A)=a\left[\begin{matrix} 1 \\ 1 \\ -1  \end{matrix}\right],\ a\in \mathbb R$$

零空间是向量空间这一结论不是那么显然的，比如 $Ax=b,b\neq 0$ 的解空间就不是一个向量空间，因为其中不包含x=0，所以不可能是向量空间。还是以式1为例，顺便思考一下 $Ax=b,b\neq 0$ 的解空间是什么形式（如果有解的话），它应该是一条和零空间平行但不过原点的直线。因为方程组的通解形式为特解加零空间，即零空间加上一个向量，可以看作是对零空间的平移。

## 如何求零空间
好了，下面说一下怎么求零空间。例子：

$$A=\left[\begin{matrix} 1&2&2&2 \\ 2&4&6&8 \\ 3&6&8&10 \end{matrix}\right]$$

还是消元，得到阶梯形矩阵：

$$U=\left[\begin{matrix} \boldsymbol 1&2&2&2 \\ 0&0&\boldsymbol 2&4 \\ 0&0&0&0 \end{matrix}\right]$$

主元所在的列称为主列（pivots column），其他列称为free column，之所以叫自由列是因为我们可以对该列对应的x分量随意取值，而求解其他分量即可。比如这里可以先取 $x_2=1,x_4=0$，再取 $x_2=0,x_4=1$，分别解得：

$$x=\left[\begin{matrix} -2 \\ 1 \\ 0 \\ 0 \end{matrix}\right],x=\left[\begin{matrix} 2 \\ 0 \\ -2 \\ 1 \end{matrix}\right]$$

那么零空间就是上面两个向量的线性组合组成的向量空间。一般来说我们分别对每一个自由变量取1，其他自由变量取0，求解其他变量。每个自由变量对应一个特解，整个零空间就是这些特解的线性组合。**对于秩为r的 $m\times n$ 矩阵，其零空间维数为 $n-r$。**

矩阵U可以继续化简，将主元上下所有元素消元为零，并除以主元使主元为1，得到：

$$R=\left[\begin{matrix} 1&2&0&-2 \\ 0&0&1&2 \\ 0&0&0&0 \end{matrix}\right]$$

该矩阵称为A的简化行阶梯式（reduced row echelon form），记为 $rref(A)$。可以看出其中包含一个单位阵，而剩下的元素刚好是两个特解中元素的相反数。这么巧吗？其实不是巧合。我们可以通过交换列把矩阵写成更好看的形式，将主列放在前面，自由列放在后面：

$$R=\left[\begin{matrix} I&F \\ 0&0 \end{matrix}\right]$$

那么Rx=0的所有特解组作为列组成的矩阵可以表示为：

$$N=\left[\begin{matrix} -F \\ I \end{matrix}\right]$$

可以证明$RN=0$。

# 6.求解AX=b
先是有解条件，其实上一节中我提到了。$Ax=b$ 有解，当且仅当 $b\in C(A)$。那么有解的情况下，怎么求解呢？和求零空间差不多，先消元确定主列，再将所有自由变量设为0，求解主变量，得到一个特解。然后，这个特解加上A的零空间中的每个向量就得到了所有的解。还是用上一节的矩阵做例子，设 $b=\left[\begin{matrix} 1&5&6 \end{matrix}\right]^T$，则Ax=b的解可以表示为：

$$x=\left[\begin{matrix} -2 \\ 0 \\ 1.5 \\ 0 \end{matrix}\right]+a\left[\begin{matrix} -2 \\ 1 \\ 0 \\ 0 \end{matrix}\right]+b\left[\begin{matrix} 2 \\ 0 \\ -2 \\ 1 \end{matrix}\right]$$

其中第一个向量就是特解，后面两个是零空间的一组基。至于解空间的几何形式，也像上一节说的，相当于将零空间平移了一个特解向量。

本节课最后，讨论了解的数量和矩阵大小与秩的关系。对于 $m\times n$ 矩阵，其秩为 $r$，有以下情况：
1. $r=m=n, R=I$，有唯一解。A是满秩方阵，通过求逆即可求解。
2. $r=m<n, R=\left[\begin{matrix}I & F\end{matrix}\right]$，有无穷多解。因为所有行是线性无关的，所以一定有解，而零空间的维数大于0（因为自由变量数大于0），所以其中有无穷多向量，所以有无穷多解。
3. $r=n<m, R=\left[\begin{matrix}I \\ 0\end{matrix}\right]$，无解或有一个解。因为矩阵所有列是线性无关的，所以如果b不在列空间中则无解，如果在列空间中，则只有一个解。
4. $r<m,r<n,R=\left[\begin{matrix}I & F \\0&0\end{matrix}\right]$，无解或无穷多解。不是行满秩，b可能不在列空间，所以可能无解；如果有解，因为零空间维数大于0，所以有无穷多解。

# 7.基和维数
## 线性无关
首先重申一个推论：对于 $m\times n(m<n)$ 的矩阵，一定存在非零的x使Ax=0，因为主元数不大于m，小于n，所以自由变量数大于0，所以零空间中一定有非零解。有此结论我们讨论线性无关。

向量组线性无关的定义是找不到一种非全零的线性组合得到零向量。所以**如果A的零空间中只有零向量，则A的所有列是线性无关的；否则是线性相关的。**

## 生成空间
一组向量的生成空间是这些向量所有线性组合的集合。矩阵的列空间就是所有列生成的空间。

## 向量空间的基
向量空间的基需要满足两个条件：
1. 它们是线性无关的
2. 它们可以生成该空间

所以基的数量不能多也不能少，多了可能不满足线性无关，少了可能不能生成整个空间。

## 向量空间的维数
我们都知道 $\mathbb R^3$ 的基有三个，虽然不一定是哪三个，$\mathbb R^n$ 的基有n个。**一个向量空间的所有基中所包含的向量数量都是一样的，该数量称为空间的维数（dimension）。**

例子来了：

$$A=\left[\begin{matrix} 1&2&3&1 \\ 1&1&2&1 \\ 1&2&3&1 \end{matrix}\right]$$

矩阵A消元后有两个主元，所以矩阵A的秩为2，列空间维数为2。

$$2=rank(A)=\#\ pivot\ columns=dim\ C(A)$$

那么我们知道了列空间的维数等于矩阵的秩，零空间呢？经过消元有两个主元，则还有两个自由变量，零空间的维数等于2。

$$\begin{align} dim\ C(A)&=rank(A) \\ dim\ N(A)&=\#\ free\ variables=n-r\end{align}$$

# 8.四个基本子空间
先亮个相，$A\in \mathbb R^{m\times n}$：
1. 列空间 $C(A)\ in\ \mathbb R^m$
2. 零空间 $N(A)\ in\ \mathbb R^n$
3. 行空间 $C(A^T)\ in\ \mathbb R^n$
4. A的转置的零空间，也叫左零空间 $N(A^T)\ in\ \mathbb R^m$

下面讨论它们的基和维数。假设经过消元有r个主元，即 $rank(A)=r$，那么列空间的维数为r，基可以选择主列。**$dim\ C(A)=r$**。零空间的基是选择自由变量后计算出的特解，数量和自由变量数量相等，为n-r个，所以维数为n-r。**$dim\ N(A)=n-r$**。

行空间的维数可以通过rref（A）看出，因为行变换不改变行空间，所以线性无关的行的数量就是主元的数量，行空间的基可以取rref（A）中主元所在的那几行。所以 **$dim\ C(A^T)=r$**。

我们还记得矩阵左乘一个向量相当于矩阵行的线性组合，所以A的转置的零空间又叫左零空间，即 $\{x|x^TA=0\}$。那么如何求它的基和维数呢。还记得矩阵求逆时的高斯约当消元吗。

$$rref\left[A_{m\times n}\ I_{m\times m}\right]=E\left[A\ I\right]=\left[R_{m\times n}\ E_{m\times m}\right]\\ \Rightarrow\ EA=R$$

E是所有行变换等价的变换矩阵。还用上面那个A做例子，得到EA=R：

$$\left[\begin{matrix} -1&2&0 \\ 1&-1&0 \\ -1&0&1 \end{matrix}\right]
\left[\begin{matrix} 1&2&3&1 \\ 1&1&2&1 \\ 1&2&3&1 \end{matrix}\right]=
\left[\begin{matrix} 1&0&1&1 \\ 0&1&1&0 \\ 0&0&0&0 \end{matrix}\right]$$

可以看出左零空间的维数了么。E的最后一行乘以A得到零向量，所以左零空间维数为1，基就是E的最后一行。**$dim\ N(A^T)=m-r$**。

总结一下，**列空间和左零空间都在 $\mathbb R^m$ 中，且维数相加等于m，行空间和零空间都在 $\mathbb R^n$ 中，维数相加等于n。** 这也不是巧合，后面会说，这是因为它们有正交关系。

# 9.其他非向量空间
## 矩阵空间
把矩阵看作向量组成一个线性空间。该空间的子空间可以是所有对称矩阵组成的集合，或者上三角矩阵，下三角矩阵，对角矩阵等等，我们也可以考虑它们的维数。假设我们考虑3阶方阵，记对称矩阵组成的子空间为S，上三角矩阵组成的空间为U，则有 $dim\ S=6,\ dim\ U=6$。S和U的交集是对角阵，其维数为3，并集则可以得到所有矩阵，维数为9。

$$dim\ S+dim\ U=dim\ (S\cap U)+dim\ (S\cup U)$$

## 函数空间
函数也可以组成一个线性空间。比如微分方程的解：

$$\frac{\mathrm d^2y}{\mathrm dx^2}+y=0 \\
y=c_1\sin x+c_2\cos x$$

解空间就是一个线性空间，维数为2，基是两个函数。

## 线性代数在图中的应用
本节课讲了线性代数在电路分析中的应用，用矩阵表示一个图结构，每行表示一条边，代表了节点之间的连接关系，每列表示一个节点。最后十分惊艳的是用矩阵基本子空间的维数关系证明了欧拉公式。我就不详细记录了。感觉是漏掉了很重要的东西。
